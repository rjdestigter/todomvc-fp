(this["webpackJsonptodomvc-fp"]=this["webpackJsonptodomvc-fp"]||[]).push([[0],{112:function(t,e,n){t.exports=n(142)},113:function(t,e,n){},117:function(t,e){},119:function(t,e){},142:function(t,e,n){"use strict";n.r(e);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(113);var c,r,i,a,o,u,f,p=n(1),s=n(31),b=n(4),d=n(21),l=n(19),O=n(10),j=n(15),m=n(12),h=n(14),v=n(37),E=n(8),y=n(24),g=n(27),w=n(11),k=n(32),L=n(33),x=n(34),B="@uri/emitter",M=function(t,e){return function(n){return p.f.fromSource(p.c.managed.chain(p.c.bracket(p.a.accessM((function(c){return p.a.sync((function(){var r=p.f.su.queueUtils(),i=r.next,a=r.ops,o=r.hasCB;return{unsubscribe:(n?c[B].addEventListener(n):c[B].fromEvent)(t)((function(t){return i({_tag:"offer",a:t}),e})),ops:a,hasCB:o}}))})),(function(t){return t.unsubscribe})),(function(t){var e=t.ops,n=t.hasCB;return p.f.su.emitter(e,n)})))}},T=Object(j.a)({},"@uri/document",document),N=p.a.provide(T),z=p.a.accessM(Object(E.flow)((function(t){return t["@uri/document"]}),p.a.pure)),A=Object(j.a)({},"@uri/dom",{createElement:function(t,e){return document.createElement(t,e)}}),q=p.a.provide(A),F=function(t){Object(k.a)(n,t);var e=Object(L.a)(n);function n(t){var c;return Object(w.a)(this,n),(c=e.call(this,"$(".concat(t,") did not return an element."))).name="ElementNotFound",c}return n}(Object(x.a)(Error)),P=function(t){Object(k.a)(n,t);var e=Object(L.a)(n);function n(t){var c;return Object(w.a)(this,n),(c=e.call(this,"Parent of node: ".concat(t," not found."))).name="ParentElementNotFound",c}return n}(Object(x.a)(Error)),S=function(t){return new F(t)},V=(Object(E.flow)(S,p.a.raiseError),function(t){return new P(t.toString())}),D=(Object(E.flow)(V,p.a.raiseError),function(t){return function(e){return m.fromNullable(e.querySelector(t))}}),U=function(t){return Object(b.pipe)(z,p.a.map(D(t)),p.a.chain(p.a.fromOption(Object(E.constant)(S(t)))))},C=function(t){return m.fromNullable(t.parentElement)},H=function(t){Object(k.a)(n,t);var e=Object(L.a)(n);function n(t){var c;return Object(w.a)(this,n),(c=e.call(this,t)).name="EmptyOptionOfElement",c}return n}(Object(x.a)(Error)),I=(c="click",n(49)),J=Object(j.a)({},"@uri/fetch",{fetch:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new Promise((function(t){setTimeout((function(){t(window.fetch.bind(window).apply(void 0,e))}),2e3)}))}}),W=p.a.provide(J),$=function(t){Object(k.a)(n,t);var e=Object(L.a)(n);function n(t){var c;return Object(w.a)(this,n),(c=e.call(this,"Unable to fetch: ".concat(t))).name="FetchFailed",c}return n}(Object(x.a)(Error)),Q=function(t){return function(t){return new $("Fetching data from ")}},R=n(105),_=y.e({id:y.b,userId:y.b,title:y.d,completed:y.a},"Todo"),G=y.c(_),K=v.contramap((function(t){return t.id}))(v.eqNumber),X=(r={todos:[],filterBy:"all",new:""},Object(b.pipe)(p.d.unboundedQueue(),p.a.zip(p.e.makeRef(r?[r]:[])),p.a.chain((function(t){var e=Object(O.a)(t,2),n=e[0],c=e[1],r=function(t){return Object(b.pipe)(c.update((function(e){var n=Object(O.a)(e,1)[0];return[t(n)]})),p.a.chain((function(t){var e=Object(O.a)(t,1)[0];return n.offer(e)})))},i=Object(b.pipe)(c.get,p.a.map(h.head));return Object(b.pipe)(Object(R.subject)(p.f.fromSource(p.c.pure(Object(b.pipe)(n.take,p.a.map(m.some))))),p.a.map((function(t){return Object(l.a)({},t,{get:i,next:r})})))})))),Y=p.a.provideM(Object(b.pipe)(X,p.a.map((function(t){return Object(j.a)({},"@uri/todo-store",t)})))),Z=Object(b.pipe)(p.a.access((function(t){return t["@uri/todo-store"]}))),tt=Object(b.pipe)((i="https://jsonplaceholder.typicode.com/todos",p.a.accessM((function(t){return p.a.async((function(e){try{t["@uri/fetch"].fetch(i,a).then((function(t){return t.json()})).then(Object(E.flow)(I.right,e))}catch(n){e(I.left(Q("string"===typeof i||i.url)(n)))}return function(t){t(Q("string"===typeof i||i.url)(""))}}))}))),p.a.chain((function(t){return p.a.sync((function(){return G.decode(t)}))})),p.a.chain(p.a.fromEither)),et=(o="div",p.a.accessM((function(t){return p.a.pure(t["@uri/dom"].createElement(o,u))}))),nt=Object(b.pipe)(et,p.a.chain((function(t){return p.a.sync((function(){return t.innerHTML='<li>\n    <div class="view">\n        <input data-toggle class="toggle" type="checkbox">\n        <label data-edit></label>\n        <button data-remove class="destroy"></button>\n    </div>\n    <input class="edit" />\n</li>',D("li")(t)}))})),p.a.chain(p.a.fromOption(Object(E.constant)(S("Unable to create DOM element for todo item."))))),ct=U(".todo-list"),rt=function(t){return function(e){return Object(b.pipe)(Object(g.Do)(m.option).bind("label",D("label")(e)).bind("checkbox",D("input")(e)).bind("input",D("input.edit")(e)).return((function(n){var c=n.label,r=n.checkbox,i=n.input;return p.a.sync((function(){return c.innerHTML=t.title,e.setAttribute("data-todo-id",""+t.id),t.completed?e.classList.add("completed"):e.classList.remove("completed"),r.checked=t.completed,i.value=t.title,e}))})),p.a.fromOption(Object(E.constant)(Error(""))),p.a.chain(E.identity))}},it=Object(b.pipe)(ct,p.f.encaseEffect,p.f.chain(Object(b.pipe)(M("click"))),p.f.map((function(t){return t.target})),p.f.map(m.fromNullable),p.f.chain(p.f.fromOption),p.f.chain((function(t){var e=t,n=function(t){return Object(b.pipe)(C(t),m.chain((function(t){return C(t)})),p.a.pure,p.a.chain(p.a.fromOption(Object(E.constant)(V(t)))),p.a.map((function(t){return Object(b.pipe)(t.getAttribute("data-todo-id"),m.fromNullable,m.map(Number),m.map((function(e){return Object(E.tuple)(e,t)})))})),p.a.chain(p.a.fromOption(Object(E.constant)(V(t)))))}(e);return e.hasAttribute("data-remove")?Object(b.pipe)(n,p.a.zip(Z),p.a.chain((function(t){var e=Object(O.a)(t,2),n=Object(O.a)(e[0],1)[0];return e[1].next((function(t){return Object(l.a)({},t,{todos:t.todos.filter((function(t){return t.id!==n}))})}))})),p.f.encaseEffect):e.hasAttribute("data-toggle")?Object(b.pipe)(n,p.a.zip(Z),p.a.chain((function(t){var e=Object(O.a)(t,2),n=Object(O.a)(e[0],1)[0];return e[1].next((function(t){return Object(l.a)({},t,{todos:t.todos.map((function(t){return t.id===n?Object(l.a)({},t,{completed:!t.completed}):t}))})}))})),p.f.encaseEffect):e.hasAttribute("data-edit")?Object(b.pipe)(n,p.a.chain((function(t){var e=Object(O.a)(t,2),n=e[0],c=e[1],r=p.a.sync((function(){c.classList.add("editing")})),i=p.a.sync((function(){c.classList.remove("editing")})),a=Object(b.pipe)(c,D("input.edit"),p.a.fromOption(Object(E.constant)(S("li>input"))),p.a.chain((function(t){var e=p.a.sync((function(){t.focus(),t.select()})),c=Object(b.pipe)(t,M("blur"),p.f.take(1),p.f.drain,p.a.zip(i)),r=Object(b.pipe)(t,M("input"),p.f.chain(Object(E.constant)(Object(b.pipe)(Z,p.a.chain((function(e){return e.next((function(e){return Object(l.a)({},e,{todos:e.todos.map((function(e){return e.id===n?Object(l.a)({},e,{title:t.value}):e}))})}))})),p.f.encaseEffect))),p.f.takeUntil(c),p.f.drain);return Object(b.pipe)(e,p.a.zip(r))})));return Object(b.pipe)(r,p.a.zip(a))})),p.f.encaseEffect):p.f.encaseEffect(p.a.pure(Object(E.constVoid)()))})),p.f.drain),at=Object(b.pipe)(tt,p.a.chain((function(t){return Object(b.pipe)(Z,p.a.chain((function(e){return e.next((function(e){return Object(l.a)({},e,{todos:t})}))})))}))),ot=p.a.Do().bind("store",Z).bindL("subscription",(function(t){return t.store.subscribe})).doL((function(t){var e=t.subscription;return Object(b.pipe)(e,p.f.chain(Object(E.flow)(s.a,p.f.encaseEffect)),p.f.drain)})).return(E.constVoid),ut=[],ft=h.difference(K),pt=p.a.pure(m.none),st=function(t){return function(e){return Object(b.pipe)(e,h.reduce(pt,(function(e,n){return Object(b.pipe)(e,p.a.chain((function(e){return Object(b.pipe)(t,D('[data-todo-id="'.concat(n.id,'"]')),m.fold(Object(E.constant)(function(t){return function(e){return function(n){return Object(b.pipe)(nt,p.a.chain(rt(n)),p.a.chainTap((function(n){return Object(b.pipe)(e,m.fold(Object(E.constant)(p.a.sync((function(){return t.prepend(n)}))),(function(t){return p.a.sync((function(){return t.after(n)}))})))})))}}}(t)(e)(n)),rt(n)),p.a.map(m.some))})))})))}},bt=p.a.Do().bind("store",Z).bindL("subscription",(function(t){return t.store.subscribe})).bind("ul",ct).doL((function(t){var e=t.subscription,n=t.ul;return Object(b.pipe)(e,p.f.map((function(t){return"all"===t.filterBy?t.todos:Object(b.pipe)(t.todos,h.filter((function(e){return"completed"===t.filterBy?e.completed:!e.completed})))})),p.f.map(h.takeLeft(10)),p.f.scan(Object(E.tuple)(ut,ut),(function(t,e){var n=Object(O.a)(t,1)[0];return Object(E.tuple)(e,n)})),p.f.chain((function(t){var e,c=Object(O.a)(t,2),r=c[0],i=c[1];return p.f.encaseEffect(Object(b.pipe)((e=ft(i,r),Object(b.pipe)(e,h.map((function(t){return Object(b.pipe)(U('[data-todo-id="'.concat(t.id,'"]')),p.a.chain((function(t){return p.a.sync(t.remove.bind(t))})))})),h.readonlyArray.sequence(p.a.effect))),p.a.zip(st(n)(r))))})),p.f.drain)})).return(E.constVoid),dt=Object(b.pipe)(Z,p.a.chain((function(t){return t.subscribe})),p.f.encaseEffect,p.f.chain(E.identity),p.f.map((function(t){return t.todos})),p.f.map((function(t){return Object(b.pipe)(t,h.filter((function(t){return!t.completed})))})),p.f.map((function(t){return t.length})),p.f.chain((function(t){return p.f.encaseEffect(Object(b.pipe)(U(".todo-count"),p.a.map(D("strong")),p.a.chain(p.a.fromOption(Object(E.constant)(S(".todo-count > strong")))),p.a.chain((function(e){return p.a.sync((function(){e.innerHTML=""+t}))}))))})),p.f.drain),lt=function(t){return Object(b.pipe)(U("#btn-filter-".concat(t)),p.f.encaseEffect,p.f.chain(M("click")),p.f.chain(Object(E.constant)(p.f.encaseEffect(Object(b.pipe)(p.a.parSequenceT(U("#btn-filter-all"),U("#btn-filter-active"),U("#btn-filter-completed")),p.a.chain((function(t){return p.a.sync((function(){t.forEach((function(t){return t.classList.remove("selected")}))}))})))))),p.f.chain(Object(E.constant)(p.f.encaseEffect(Object(b.pipe)(Z,p.a.chain((function(e){return e.next((function(e){return Object(l.a)({},e,{filterBy:t})}))})))))),p.f.chain(Object(E.constant)(p.f.encaseEffect(Object(b.pipe)(U("#btn-filter-".concat(t)),p.a.chain((function(t){return p.a.sync((function(){t.classList.add("selected")}))})))))),p.f.drain)},Ot=Object(b.pipe)(U(".clear-completed"),p.f.encaseEffect,p.f.chain(M("click")),p.f.chain(Object(E.constant)(p.f.encaseEffect(Object(b.pipe)(Z,p.a.chain((function(t){return t.next((function(t){return Object(l.a)({},t,{todos:Object(b.pipe)(t.todos,h.filter((function(t){return!t.completed})))})}))})))))),p.f.drain),jt=Object(b.pipe)(U(".new-todo"),p.f.encaseEffect,p.f.chain(M("keyup")),p.f.filter((function(t){return"Enter"===t.key})),p.f.map((function(t){return t.currentTarget})),p.f.map(m.fromNullable),p.f.chain(p.f.fromOption),p.f.filter((function(t){return!!t.value.trim()})),p.f.chain((function(t){return p.f.encaseEffect(Object(b.pipe)(Z,p.a.chain((function(e){return e.next((function(e){return Object(l.a)({},e,{todos:[{id:Math.random(),title:t.value,completed:!1,userId:Math.random()}].concat(Object(d.a)(e.todos))})}))})),p.a.chain(Object(E.constant)(p.a.sync((function(){t.value=""}))))))})),p.f.drain),mt=function t(e){return Object(b.pipe)(e,h.foldLeft(E.constTrue,(function(e,n){return e.completed&&t(n)})))},ht=Object(b.pipe)(U("#toggle-all"),p.a.zip(Z),p.a.chain((function(t){var e=Object(O.a)(t,2),n=e[0],c=e[1];return Object(b.pipe)(c.subscribe,p.a.map((function(t){return Object(E.tuple)(n,c,t)})))})),p.f.encaseEffect,p.f.chain((function(t){var e=Object(O.a)(t,3),n=e[0],c=e[1],r=e[2],i=Object(b.pipe)(r,p.f.map((function(t){return"all"===t.filterBy?t.todos:Object(b.pipe)(t.todos,h.filter((function(e){return"completed"===t.filterBy?e.completed:!e.completed})))})),p.f.map(h.takeLeft(10)),p.f.map((function(t){return Object(E.tuple)(mt(t),t)})),p.f.chain((function(t){var e=Object(O.a)(t,2),c=e[0];e[1];return p.f.encaseEffect(p.a.sync((function(){n.checked=c})))})),p.f.map(E.constVoid)),a=Object(b.pipe)(M("click")(n),p.f.chain(Object(E.constant)(p.f.encaseEffect(Object(b.pipe)(c.get,p.a.chain((function(t){return Object(b.pipe)(t,m.map((function(t){var e=Object(b.pipe)("all"===t.filterBy?t.todos:Object(b.pipe)(t.todos,h.filter((function(e){return"completed"===t.filterBy?e.completed:!e.completed}))),h.takeLeft(10)),n=!mt(e);return c.next((function(t){return Object(l.a)({},t,{todos:t.todos.map((function(t){return Object(b.pipe)(e,h.findFirstMap((function(e){return e.id!==t.id?m.none:m.some(Object(l.a)({},t,{completed:n}))})),m.fold(Object(E.constant)(t),E.identity))}))})}))})),m.getOrElse(Object(E.constant)(p.a.sync(E.constVoid))))})))))),p.f.map(E.constVoid)),o=p.f.mergeAll([i,a]);return Object(b.pipe)(o)})),p.f.drain),vt=Object(b.pipe)(p.a.parSequenceT(ot,at,it,bt,dt,lt("all"),lt("active"),lt("completed"),jt,Ot,ht),Y),Et=Object(b.pipe)(vt,q,N,W,s.b,p.a.provide((f=document,Object(j.a)({},B,{fromEvent:function(t){return function(e){return f.addEventListener(t,(function(t){return t.stopPropagation(),e(t)})),p.a.sync((function(){return f.removeEventListener(t,e)}))}},addEventListener:function(t){return function(e){return function(n){return t.addEventListener(e,(function(t){return t.stopPropagation(),n(t)})),p.a.sync((function(){return t.removeEventListener(e,n)}))}}}}))));p.a.runToPromise(Et).then((function(t){return console.log("Done",t)})).catch((function(t){console.error(t)})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[112,1,2]]]);
//# sourceMappingURL=main.10d16137.chunk.js.map