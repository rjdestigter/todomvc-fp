(this["webpackJsonptodomvc-fp"]=this["webpackJsonptodomvc-fp"]||[]).push([[0],{112:function(t,n,e){t.exports=e(142)},113:function(t,n,e){},117:function(t,n){},119:function(t,n){},142:function(t,n,e){"use strict";e.r(n);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));e(113);var c,r,i,a,o,u,f,p=e(1),s=e(31),b=e(4),d=e(21),l=e(19),O=e(10),j=e(14),m=e(12),h=e(17),v=e(37),E=e(8),y=e(24),g=e(27),w=e(11),k=e(32),L=e(33),x=e(34),M="@uri/emitter",T=function(t,n){return function(e){return p.f.fromSource(p.c.managed.chain(p.c.bracket(p.a.accessM((function(c){return p.a.sync((function(){var r=p.f.su.queueUtils(),i=r.next,a=r.ops,o=r.hasCB;return{unsubscribe:(e?c[M].addEventListener(e):c[M].fromEvent)(t)((function(t){return i({_tag:"offer",a:t}),n})),ops:a,hasCB:o}}))})),(function(t){return t.unsubscribe})),(function(t){var n=t.ops,e=t.hasCB;return p.f.su.emitter(n,e)})))}},B=Object(j.a)({},"@uri/document",document),N=p.a.provide(B),z=p.a.accessM(Object(E.flow)((function(t){return t["@uri/document"]}),p.a.pure)),A=Object(j.a)({},"@uri/dom",{createElement:function(t,n){return document.createElement(t,n)}}),q=p.a.provide(A),F=function(t){Object(k.a)(e,t);var n=Object(L.a)(e);function e(t){var c;return Object(w.a)(this,e),(c=n.call(this,"$(".concat(t,") did not return an element."))).name="ElementNotFound",c}return e}(Object(x.a)(Error)),P=function(t){Object(k.a)(e,t);var n=Object(L.a)(e);function e(t){var c;return Object(w.a)(this,e),(c=n.call(this,"Parent of node: ".concat(t," not found."))).name="ParentElementNotFound",c}return e}(Object(x.a)(Error)),S=function(t){return new F(t)},V=(Object(E.flow)(S,p.a.raiseError),function(t){return new P(t.toString())}),D=(Object(E.flow)(V,p.a.raiseError),function(t){return function(n){return m.fromNullable(n.querySelector(t))}}),U=function(t){return Object(b.pipe)(z,p.a.map(D(t)),p.a.chain(p.a.fromOption(Object(E.constant)(S(t)))))},C=function(t){return m.fromNullable(t.parentElement)},H=function(t){Object(k.a)(e,t);var n=Object(L.a)(e);function e(t){var c;return Object(w.a)(this,e),(c=n.call(this,t)).name="EmptyOptionOfElement",c}return e}(Object(x.a)(Error)),I=(c="click",e(49)),J=Object(j.a)({},"@uri/fetch",{fetch:function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return new Promise((function(t){setTimeout((function(){t(window.fetch.bind(window).apply(void 0,n))}),2e3)}))}}),W=p.a.provide(J),$=function(t){Object(k.a)(e,t);var n=Object(L.a)(e);function e(t){var c;return Object(w.a)(this,e),(c=n.call(this,"Unable to fetch: ".concat(t))).name="FetchFailed",c}return e}(Object(x.a)(Error)),Q=function(t){return function(t){return new $("Fetching data from ")}},R=e(105),_=function(t){var n,e=void 0;return function(c){return null==e&&(e=c),c===e&&null!=n||(n=t(e=c)),n}},G=y.e({id:y.b,userId:y.b,title:y.d,completed:y.a},"Todo"),K=y.c(G),X=v.contramap((function(t){return t.id}))(v.eqNumber),Y=_((function(t){return _((function(n){return"all"===t?n:Object(b.pipe)(n,h.filter((function(n){return"completed"===t?n.completed:!n.completed})))}))})),Z=_(h.takeLeft(10)),tt=(r={todos:[],filterBy:"all"},Object(b.pipe)(p.d.unboundedQueue(),p.a.zip(p.e.makeRef(r?[r]:[])),p.a.chain((function(t){var n=Object(O.a)(t,2),e=n[0],c=n[1],r=function(t){return Object(b.pipe)(c.update((function(n){var e=Object(O.a)(n,1)[0];return[t(e)]})),p.a.chain((function(t){var n=Object(O.a)(t,1)[0];return e.offer(n)})))},i=Object(b.pipe)(c.get,p.a.map(h.head));return Object(b.pipe)(Object(R.subject)(p.f.fromSource(p.c.pure(Object(b.pipe)(e.take,p.a.map(m.some))))),p.a.map((function(t){return Object(l.a)({},t,{get:i,next:r})})))})))),nt=p.a.provideM(Object(b.pipe)(tt,p.a.map((function(t){return Object(j.a)({},"@uri/todo-store",t)})))),et=Object(b.pipe)(p.a.access((function(t){return t["@uri/todo-store"]}))),ct=Object(b.pipe)((i="https://jsonplaceholder.typicode.com/todos",p.a.accessM((function(t){return p.a.async((function(n){try{t["@uri/fetch"].fetch(i,a).then((function(t){return t.json()})).then(Object(E.flow)(I.right,n))}catch(e){n(I.left(Q("string"===typeof i||i.url)(e)))}return function(t){t(Q("string"===typeof i||i.url)(""))}}))}))),p.a.chain((function(t){return p.a.sync((function(){return K.decode(t)}))})),p.a.chain(p.a.fromEither)),rt=(o="div",p.a.accessM((function(t){return p.a.pure(t["@uri/dom"].createElement(o,u))}))),it=Object(b.pipe)(rt,p.a.chain((function(t){return p.a.sync((function(){return t.innerHTML='<li>\n    <div class="view">\n        <input data-toggle class="toggle" type="checkbox">\n        <label data-edit></label>\n        <button data-remove class="destroy"></button>\n    </div>\n    <input class="edit" />\n</li>',D("li")(t)}))})),p.a.chain(p.a.fromOption(Object(E.constant)(S("Unable to create DOM element for todo item."))))),at=U(".todo-list"),ot=function(t){return function(n){return Object(b.pipe)(Object(g.Do)(m.option).bind("label",D("label")(n)).bind("checkbox",D("input")(n)).bind("input",D("input.edit")(n)).return((function(e){var c=e.label,r=e.checkbox,i=e.input;return p.a.sync((function(){return c.innerHTML=t.title,n.setAttribute("data-todo-id",""+t.id),t.completed?n.classList.add("completed"):n.classList.remove("completed"),r.checked=t.completed,i.value=t.title,n}))})),p.a.fromOption(Object(E.constant)(Error(""))),p.a.chain(E.identity))}},ut=Object(b.pipe)(at,p.f.encaseEffect,p.f.chain(Object(b.pipe)(T("click"))),p.f.map((function(t){return t.target})),p.f.map(m.fromNullable),p.f.chain(p.f.fromOption),p.f.chain((function(t){var n=t,e=function(t){return Object(b.pipe)(C(t),m.chain((function(t){return C(t)})),p.a.pure,p.a.chain(p.a.fromOption(Object(E.constant)(V(t)))),p.a.map((function(t){return Object(b.pipe)(t.getAttribute("data-todo-id"),m.fromNullable,m.map(Number),m.map((function(n){return Object(E.tuple)(n,t)})))})),p.a.chain(p.a.fromOption(Object(E.constant)(V(t)))))}(n);return n.hasAttribute("data-remove")?Object(b.pipe)(e,p.a.zip(et),p.a.chain((function(t){var n=Object(O.a)(t,2),e=Object(O.a)(n[0],1)[0];return n[1].next((function(t){return Object(l.a)({},t,{todos:t.todos.filter((function(t){return t.id!==e}))})}))})),p.f.encaseEffect):n.hasAttribute("data-toggle")?Object(b.pipe)(e,p.a.zip(et),p.a.chain((function(t){var n=Object(O.a)(t,2),e=Object(O.a)(n[0],1)[0];return n[1].next((function(t){return Object(l.a)({},t,{todos:t.todos.map((function(t){return t.id===e?Object(l.a)({},t,{completed:!t.completed}):t}))})}))})),p.f.encaseEffect):n.hasAttribute("data-edit")?Object(b.pipe)(e,p.a.chain((function(t){var n=Object(O.a)(t,2),e=n[0],c=n[1],r=p.a.sync((function(){c.classList.add("editing")})),i=p.a.sync((function(){c.classList.remove("editing")})),a=Object(b.pipe)(c,D("input.edit"),p.a.fromOption(Object(E.constant)(S("li>input"))),p.a.chain((function(t){var n=p.a.sync((function(){t.focus(),t.select()})),c=Object(b.pipe)(t,T("blur"),p.f.take(1),p.f.drain,p.a.zip(i)),r=Object(b.pipe)(t,T("input"),p.f.chain(Object(E.constant)(Object(b.pipe)(et,p.a.chain((function(n){return n.next((function(n){return Object(l.a)({},n,{todos:n.todos.map((function(n){return n.id===e?Object(l.a)({},n,{title:t.value}):n}))})}))})),p.f.encaseEffect))),p.f.takeUntil(c),p.f.drain);return Object(b.pipe)(n,p.a.zip(r))})));return Object(b.pipe)(r,p.a.zip(a))})),p.f.encaseEffect):p.f.encaseEffect(p.a.pure(Object(E.constVoid)()))})),p.f.drain),ft=Object(b.pipe)(ct,p.a.chain((function(t){return Object(b.pipe)(et,p.a.chain((function(n){return n.next((function(n){return Object(l.a)({},n,{todos:t})}))})))}))),pt=p.a.Do().bind("store",et).bindL("subscription",(function(t){return t.store.subscribe})).doL((function(t){var n=t.subscription;return Object(b.pipe)(n,p.f.chain(Object(E.flow)(s.a,p.f.encaseEffect)),p.f.drain)})).return(E.constVoid),st=[],bt=h.difference(X),dt=p.a.pure(m.none),lt=function(t){return function(n){return Object(b.pipe)(n,h.reduce(dt,(function(n,e){return Object(b.pipe)(n,p.a.chain((function(n){return Object(b.pipe)(t,D('[data-todo-id="'.concat(e.id,'"]')),m.fold(Object(E.constant)(function(t){return function(n){return function(e){return Object(b.pipe)(it,p.a.chain(ot(e)),p.a.chainTap((function(e){return Object(b.pipe)(n,m.fold(Object(E.constant)(p.a.sync((function(){return t.prepend(e)}))),(function(t){return p.a.sync((function(){return t.after(e)}))})))})))}}}(t)(n)(e)),ot(e)),p.a.map(m.some))})))})))}},Ot=p.a.Do().bind("store",et).bindL("subscription",(function(t){return t.store.subscribe})).bind("ul",at).doL((function(t){var n=t.subscription,e=t.ul;return Object(b.pipe)(n,p.f.map((function(t){return"all"===t.filterBy?t.todos:Object(b.pipe)(t.todos,h.filter((function(n){return"completed"===t.filterBy?n.completed:!n.completed})))})),p.f.map(Z),p.f.scan(Object(E.tuple)(st,st),(function(t,n){var e=Object(O.a)(t,1)[0];return Object(E.tuple)(n,e)})),p.f.chain((function(t){var n,c=Object(O.a)(t,2),r=c[0],i=c[1];return p.f.encaseEffect(Object(b.pipe)((n=bt(i,r),Object(b.pipe)(n,h.map((function(t){return Object(b.pipe)(U('[data-todo-id="'.concat(t.id,'"]')),p.a.chain((function(t){return p.a.sync(t.remove.bind(t))})))})),h.readonlyArray.sequence(p.a.effect))),p.a.zip(lt(e)(r))))})),p.f.drain)})).return(E.constVoid),jt=Object(b.pipe)(et,p.a.chain((function(t){return t.subscribe})),p.f.encaseEffect,p.f.chain(E.identity),p.f.map((function(t){return t.todos})),p.f.map((function(t){return Object(b.pipe)(t,h.filter((function(t){return!t.completed})))})),p.f.map((function(t){return t.length})),p.f.chain((function(t){return p.f.encaseEffect(Object(b.pipe)(U(".todo-count"),p.a.map(D("strong")),p.a.chain(p.a.fromOption(Object(E.constant)(S(".todo-count > strong")))),p.a.chain((function(n){return p.a.sync((function(){n.innerHTML=""+t}))}))))})),p.f.drain),mt=function(t){return Object(b.pipe)(U("#btn-filter-".concat(t)),p.f.encaseEffect,p.f.chain(T("click")),p.f.chain(Object(E.constant)(p.f.encaseEffect(Object(b.pipe)(p.a.parSequenceT(U("#btn-filter-all"),U("#btn-filter-active"),U("#btn-filter-completed")),p.a.chain((function(t){return p.a.sync((function(){t.forEach((function(t){return t.classList.remove("selected")}))}))})))))),p.f.chain(Object(E.constant)(p.f.encaseEffect(Object(b.pipe)(et,p.a.chain((function(n){return n.next((function(n){return Object(l.a)({},n,{filterBy:t})}))})))))),p.f.chain(Object(E.constant)(p.f.encaseEffect(Object(b.pipe)(U("#btn-filter-".concat(t)),p.a.chain((function(t){return p.a.sync((function(){t.classList.add("selected")}))})))))),p.f.drain)},ht=Object(b.pipe)(U(".clear-completed"),p.f.encaseEffect,p.f.chain(T("click")),p.f.chain(Object(E.constant)(p.f.encaseEffect(Object(b.pipe)(et,p.a.chain((function(t){return t.next((function(t){return Object(l.a)({},t,{todos:Object(b.pipe)(t.todos,h.filter((function(t){return!t.completed})))})}))})))))),p.f.drain),vt=Object(b.pipe)(U(".new-todo"),p.f.encaseEffect,p.f.chain(T("keyup")),p.f.filter((function(t){return"Enter"===t.key})),p.f.map((function(t){return t.currentTarget})),p.f.map(m.fromNullable),p.f.chain(p.f.fromOption),p.f.filter((function(t){return!!t.value.trim()})),p.f.chain((function(t){return p.f.encaseEffect(Object(b.pipe)(et,p.a.chain((function(n){return n.next((function(n){return Object(l.a)({},n,{todos:[{id:Math.random(),title:t.value,completed:!1,userId:Math.random()}].concat(Object(d.a)(n.todos))})}))})),p.a.chain(Object(E.constant)(p.a.sync((function(){t.value=""}))))))})),p.f.drain),Et=function t(n){return Object(b.pipe)(n,h.foldLeft(E.constTrue,(function(n,e){return n.completed&&t(e)})))},yt=Object(b.pipe)(U("#toggle-all"),p.a.zip(et),p.a.chain((function(t){var n=Object(O.a)(t,2),e=n[0],c=n[1];return Object(b.pipe)(c.subscribe,p.a.map((function(t){return Object(E.tuple)(e,c,t)})))})),p.f.encaseEffect,p.f.chain((function(t){var n=Object(O.a)(t,3),e=n[0],c=n[1],r=n[2],i=Object(b.pipe)(r,p.f.map((function(t){return Y(t.filterBy)(t.todos)})),p.f.map(Z),p.f.map((function(t){return Object(E.tuple)(Et(t),t)})),p.f.chain((function(t){var n=Object(O.a)(t,2),c=n[0];n[1];return p.f.encaseEffect(p.a.sync((function(){e.checked=c})))})),p.f.map(E.constVoid)),a=Object(b.pipe)(T("click")(e),p.f.chain(Object(E.constant)(p.f.encaseEffect(Object(b.pipe)(c.get,p.a.chain((function(t){return Object(b.pipe)(t,m.map((function(t){var n=Object(b.pipe)(Y(t.filterBy)(t.todos),Z),e=!Et(n);return c.next((function(t){return Object(l.a)({},t,{todos:t.todos.map((function(t){return Object(b.pipe)(n,h.findFirstMap((function(n){return n.id!==t.id?m.none:m.some(Object(l.a)({},t,{completed:e}))})),m.fold(Object(E.constant)(t),E.identity))}))})}))})),m.getOrElse(Object(E.constant)(p.a.sync(E.constVoid))))})))))),p.f.map(E.constVoid));return p.f.mergeAll([i,a])})),p.f.drain),gt=Object(b.pipe)(p.a.parSequenceT(pt,ft,ut,Ot,jt,mt("all"),mt("active"),mt("completed"),vt,ht,yt),nt),wt=Object(b.pipe)(gt,q,N,W,s.b,p.a.provide((f=document,Object(j.a)({},M,{fromEvent:function(t){return function(n){return f.addEventListener(t,(function(t){return t.stopPropagation(),n(t)})),p.a.sync((function(){return f.removeEventListener(t,n)}))}},addEventListener:function(t){return function(n){return function(e){return t.addEventListener(n,(function(t){return t.stopPropagation(),e(t)})),p.a.sync((function(){return t.removeEventListener(n,e)}))}}}}))));p.a.runToPromise(wt).then((function(t){return console.log("Done",t)})).catch((function(t){console.error(t)})),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[112,1,2]]]);
//# sourceMappingURL=main.2907f088.chunk.js.map